#!/usr/bin/env bash


# convert line number suffix if there is any...
args="$@"
args=$(python -c "import re; print re.sub('(.*?):(\d*:?\d*):?$', r'+\2 \1', '$args')")

function emacsd() {
    ps -C emacs >/dev/null && return 1
    emacs $args 2>&1 >/dev/null &
    disown `pgrep emacs`  # get emacs PID and detach it from this shell.
}

( emacsd $args 2>&1 >/dev/null ) || ( emacsclient -n $args 2>&1 >/dev/null & )
